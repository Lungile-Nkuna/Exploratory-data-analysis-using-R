---
title: 'Exploratory data analysis'
author: "Prayer Lungile Nkuna"
date: "2024-03-05"
output:
  html_document: default
  pdf_document: default
---
```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = F, message = F, include = T, warning=F)
```

Loading all the necessary libraries.
```{r, echo=FALSE, eval=TRUE}
library(readr)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(cowplot)
library(patchwork)
library(maps)
library(leaflet)
library(lubridate)
library(plotly)
```

Loading data that will be used for this project.
```{r, echo= FALSE, eval= T}
Earthquakes_1965_2016 <- tibble(read.csv("Earthquakes 1965 - 2016.csv"))
query <- tibble(read.csv("query.csv"))
```

There must only be one date-time variable (note that all times are UTC). 

For this section, the date and time variables from earthquake_1965_2016 was combined into one variable named datetime.
```{r, echo= FALSE, eval= T}
# Combine Date and Time into Datetime
Earthquakes_1965_2016$Datetime <- as.POSIXct(paste(Earthquakes_1965_2016$Date, Earthquakes_1965_2016$Time), format = "%m/%d/%Y %H:%M:%S")

# Remove Date and Time columns if needed
Earthquakes_1965_2016 <- Earthquakes_1965_2016[, !(names(Earthquakes_1965_2016) %in% c("Date", "Time"))]

```


The time frames overlap; you may use/remove these observations from either set.
 
Observations dating from 1 December to 30 December 2016 were removed from the earthquake_1965_2016 dataset to avoid the overlap.
```{r,  echo= T, eval= T}
Earthquakes_1965_2016 <- Earthquakes_1965_2016 %>%
  filter(Datetime < as.POSIXct("2016-12-01") | Datetime > as.POSIXct("2016-12-30"))  #remove december 2016 from rows 
```


Variable names in the query dataset were renamed to match the earthquake_1965_2016 dataset in order to avoid merging conflicts.
```{r, echo= FALSE, eval= T}
# Renaming variables in query
query <- query %>%
  rename(
    Datetime = time,
    Latitude = latitude,
    Longitude = longitude,
    Depth = depth,
    Type = type,
    Magnitude = mag,
    Magnitude.Type = magType,
    Magnitude.Error = magError,
    Depth.Error = depthError,
    Magnitude.Seismic.Stations = magNst,
    Horizontal.Error= horizontalError,
    Root.Mean.Square = rms,
    ID = id,
    Location.Source = locationSource,
    Magnitude.Source = magSource,
    Status = status,
    Depth.Error = depthError
  )
# Now the columns are renamed
```


Explore the range of magnitudes (Richter scale) in both datasets. Is there a reason to exclude any measurements in either? Implement and discuss briefly.

The IQR method was implemented to observe if there was any need to exclude some of the measurements. For the magnitudes 1965–2016 dataset, all values are within the bounds (5.500 to 9.100), so there are no outliers based on this method. For the magnitudes 2016–2023 dataset, all values are also within the bounds (5.000 to 8.200), so there are no outliers based on this method. Therefore, based on the IQR method, there is no need to exclude any points from either set of data.
```{r, echo= FALSE, eval= T}
plot1 <- ggplot(Earthquakes_1965_2016, aes(x = Magnitude)) +
  geom_boxplot(fill = "palegreen4", width = 0.2) +
  labs(title = "Magnitudes 1965-2016") 

plot2 <- ggplot(query, aes(x  = Magnitude)) +
  geom_boxplot(fill = "palegreen4", width = 0.2) +
  labs(title = "Magnitudes 2016-2023") 

combined_plot <- cowplot::plot_grid(plot1, plot2, ncol = 2, align = "h")

print(combined_plot)

summary(Earthquakes_1965_2016$Magnitude)
summary(query$Magnitude)
```



The full join by common variables method for merging datasets was used to ensure that all rows/observations from both datasets are included in the result, regardless of whether there is a match. This was useful because we wanted to keep all the data from both datasets in the result set.
```{r, echo= FALSE, eval= T}
library(dplyr)

# Convert Datetime column in query to datetime object
query$Datetime <- as.POSIXct(query$Datetime, format = "%Y-%m-%d %H:%M:%S")


# Perform a full join
Earthquakes <- full_join(Earthquakes_1965_2016, query, by = c(
  "Datetime", "Latitude", "Longitude", "Depth", "Type", "Magnitude.Type","Magnitude",
  "Magnitude.Error", "Depth.Error", "Magnitude.Seismic.Stations",
  "Horizontal.Error", "Root.Mean.Square", "ID", "Location.Source", "Magnitude.Source", "Status"
))

```



Report on the extent of missing data in the common variables. Is it worth keeping any of the information for variables with missing data? Likewise for common variables with a discrepancy in values. Implement and discuss briefly

Some variables in the data, such as "Magnitude Error", "Depth Error", "Magnitude Seismic Stations", "Horizontal Error", "Magnitude Source", "Status", "nst", "gap", "dmin", "Depth Seismic Stations", "Azimulth Gap", "Horizontal Distance", "net", "updated", have a very high percentage of more than 50 missing values, with "Source" and "'Root Mean Square" being an exception to have less than 50 percent missing values. Since the missing data in these variables was more than 15%, the information was not worth keeping. Furthermore, among these variables with missing values, 10 of them have discrepancies in values. As a result of these missing values and discrepancies, the information was not kept since data with a lot of missing values and discrepancies results in biassed information and misinterpretation.
```{r, echo= FALSE, eval= T}
# 1. Checking the Extent of Missing Data
missing_data <- sapply(Earthquakes, function(x) sum(is.na(x)))
missing_percent <- missing_data / nrow(Earthquakes) * 100
missing_summary <- data.frame(Variable = names(missing_data), Missing_Count = missing_data, Percent_Missing = missing_percent)
print("Missing Data Summary:")
print(missing_summary)

# 3. Identifying Variables with Discrepancies
discrepancies <- select(Earthquakes, -c("Datetime", "Latitude", "Longitude", "Depth", "Type", "Magnitude.Type", "Magnitude", "Magnitude.Error", "Depth.Error", "Magnitude.Seismic.Stations", "Horizontal.Error", "Root.Mean.Square", "ID", "Location.Source", "Magnitude.Source", "Status"))  %>%
  summarise_all(funs(length(unique(.))))
print("Variables with Discrepancies:")
print(discrepancies)

# "Magnitude Error", "Depth Error", "Magnitude Seismic Stations", "Horizontal Error", "Magnitude Source", "Status", "nst", "gap", "dmin", "Depth Seismic Stations", "Azimulth Gap", "Horizontal Distance", "net", "updated", 

```

```{r, echo= FALSE, eval= T}

# Plotting the Missing Data
ggplot(missing_summary, aes(x = Variable, y = Percent_Missing)) +
  geom_bar(stat = "identity", fill = "green", color = "black") +
  labs(title = "Missing Data Summary",
       x = "Variable",
       y = "Percent Missing") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```



These are all the variables that were removed from the data since they had a high percentage of missing values and discrepancies.
```{r, echo= FALSE, eval= T}
# Columns to remove
variable_to_remove <- c("Magnitude.Error", "Depth.Error", "Magnitude.Seismic.Stations", 
                    "Horizontal.Error", "Magnitude.Source", "Status", "nst", "gap", 
                    "dmin", "Depth.Seismic.Stations", "Azimuthal.Gap", 
                    "Horizontal.Distance", "net", "updated", "place", "Root.Mean.Square")
# Remove the specified columns
earthquakes <- Earthquakes %>%
  select(-one_of(variable_to_remove))

# Now "Earthquakes" does not contain the specified columns
```


Provide a summary of the types of events and then filter the observations to only include “Earthquake” type events.
```{r, echo= FALSE, eval= T}
unique(earthquakes$Type)   

# Update the "Type" variable since earthquakes and nuclear explosion were stored differently
earthquakes <- earthquakes %>%
  mutate(Type = case_when(
    Type == "earthquake" ~ "Earthquake",
    Type == "nuclear explosion" ~ "Nuclear_Explosion",
    TRUE ~ Type  # Keep other types unchanged
  ))

# Create a bar plot using ggplot
ggplot(earthquakes, aes(x = Type)) +
  geom_bar(fill = "palegreen4", width = 0.5) +
  labs(title = "Type of Events by Frequency",
       x = "Event Type",
       y = "Frequency")


# Creating a table of event types and their frequencies

event_table <- table(earthquakes$Type)
# Convert the table to a data frame for better printing
event_df <- as.data.frame(event_table)
# Rename the columns
colnames(event_df) <- c("Event Type", "Frequency")
# Print the table
print(event_df)


unique(earthquakes$Type)

# Filter observations to include only "Earthquake" type events
earthquake_events <- earthquakes %>%
  filter(Type == "Earthquake")
```

Add a categorical variable “Scale”, which classifies the earthquakes according to their magnitude. Classify and name the categories according to the “Description” column in the table on this page.
```{r, echo= FALSE, eval= T}

# Define the magnitude scale categories and descriptions according to Ritcher scale
scale_categories <- c("Micro", "Minor", "Light", "Moderate", "Strong", "Major", "Great")
magnitude_ranges <- c(1.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, Inf)
scale_descriptions <- c("Micro","Minor", "Light", "Moderate", "Strong", "Major", "Great")

# Add the "Scale" variable to the dataset
earthquake_events <- earthquake_events %>%
  mutate(Scale = cut(Magnitude, breaks = magnitude_ranges, labels = scale_descriptions, include.lowest = TRUE))
```


```{r, echo= FALSE, eval= T}
#plotting scale of events in earthquake
ggplot(earthquake_events, aes(x = Scale)) +
  geom_bar(fill = "palegreen4", width = 0.5) +
  labs(title = "Scale of Events in earthquake by Frequency",
       x = "Scale",
       y = "Frequency")
```




2 Initial Exploration



The distributions of the features. Decide which features to investigate and provide the appropriate plots/measurements.

```{r, echo= FALSE, eval= T}

# Create density plots for Latitude, Longitude, Depth, and Magnitude
plot1 <- ggplot(earthquake_events, aes(x = Latitude, fill = Type)) +
  geom_density(alpha = 0.5, fill= "palegreen4") +
  labs(title = "Density Plot of Latitude",
       x = "Latitude",
       y = "Density") 

plot2 <- ggplot(earthquake_events, aes(x = Longitude, fill = Type)) +
  geom_density(alpha = 0.5, fill = "palegreen4") +
  labs(title = "Density Plot of Longitude",
       x = "Longitude",
       y = "Density") 

plot3 <- ggplot(earthquake_events, aes(x = Depth, fill = Type)) +
  geom_density(alpha = 0.5, fill = "palegreen4") +
  labs(title = "Density Plot of Depth",
       x = "Depth",
       y = "Density") 

plot4 <- ggplot(earthquake_events, aes(x = Magnitude, fill = Type)) +
  geom_density(alpha = 0.5, fill = "palegreen4") +
  labs(title = "Density Plot of Magnitude",
       x = "Magnitude",
       y = "Density")  

# Combine the plots into a grid
combined_plots <- plot1 + plot2 + plot3 + plot4
combined_plots <- combined_plots + plot_layout(ncol = 2)

# Print the combined plot
combined_plots

```


latitude is right skewed while longitude is left skewed. 
```{r, echo= FALSE, eval= T}
# Create individual boxplots
plot7 <- ggplot(earthquake_events, aes(x = Latitude, y = "", fill = Type)) +
  geom_boxplot(alpha = 0.5, fill= "green") +
  labs(title = "Boxplot of Latitude",
       x = NULL,
       y = "Latitude")

plot8 <- ggplot(earthquake_events, aes(x = Longitude, y = "",  fill = Type)) +
  geom_boxplot(alpha = 0.5, fill= "green") +
  labs(title = "Boxplot of Longitude",
       x = NULL,
       y = "Longitude")



# Combine the plots into a grid
combined_plots3 <- plot7 + plot8 +  plot_layout(ncol = 2)

# Print the combined plot
combined_plots3

```

Most earthquakes occur at the magnitude of 5.4MW and the depth of 10 to 50 Km. Both graphs are skewed to the right, which implies that more earthquake magnitudes and depth lie of on the right.

```{r, echo= FALSE, eval= T}

#oltting the histograms for depth and magnitude
plot5 <- ggplot(earthquake_events, aes(x = Depth, fill = Type)) +
  geom_histogram(alpha = 0.5, fill = "palegreen4") +
  labs(title = "Histogram Plot of Depth",
       x = "Depth (Km)",
       y = "Frequency") 

plot6 <- ggplot(earthquake_events, aes(x = Magnitude, fill = Type)) +
  geom_histogram(alpha = 0.5, fill = "palegreen4") +
  labs(title = "Histogram Plot of Magnitude",
       x = "Magnitude (MW)",
       y = "Frequency ") 

combined_plots56 <- plot5 + plot6
combined_plots56 <- plot5 + plot6 + plot_layout(ncol = 2)
combined_plots56

```

Most of the earthquake points plot on the tectonic plate boundaries, with most points clustered on the western parts of North and South America and the east, west, and southern parts of Asia, with some of them showing a nice pattern on the oceanic floor of the Atlantic, Indian, and Pacific oceans. 

```{r, echo= FALSE, eval= T}
 #Create a basic world map
world_map <- map_data("world")

# Plot filtered earthquakes on the world map
ggplot() +
  geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "white", color = "black") +
  geom_point(data = earthquake_events, aes(x = Longitude, y = Latitude, color = Magnitude), size = 2) +
  scale_color_continuous(name = "Magnitude", low = "lightpink", high = "darkred") +
  labs(title = " Distribution of Earthquakes Worldwide", x= "Longitude", y= "Latitude") +
  theme(
    plot.title = element_text(size = 14),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 12)
  ) +
  coord_fixed() +  # Ensure correct aspect ratio
  theme(
    plot.background = element_rect(fill = "white"),
    panel.background = element_rect(fill = "white"),
    panel.border = element_rect(colour = "black", fill = NA, size = 0.5)
  )
```



The largest earthquakes, according to magnitude. Choose a number of them and present and discuss in an appropriate way.

```{r, echo= FALSE, eval= T}
# Create a bar plot for earthquake magnitude according to Richter scale
ggplot(earthquake_events, aes(x = Scale, y = Magnitude)) +
  geom_bar(stat = "summary", fun = "mean", fill = "palegreen4", width = 0.5) +
  labs(title = "Earthquake Magnitude According to Richter Scale",
       x = "Scale",
       y = "Magnitude (Mean)") 

largest_earthquake <- earthquake_events %>%
  filter(Scale == "Great")

```

Most of the great earthquakes that range from 8.1 to 9.1 MW occur in the western parts of South and North America, Indonesia, the Pacific Ocean, and Japan.
```{r, echo= FALSE, eval= T}
# Create a basic world map
world_map <- map_data("world")

# Plot filtered earthquakes on the world map
ggplot() +
  geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "white", color = "black") +
  geom_point(data = largest_earthquake, aes(x = Longitude, y = Latitude, color = Magnitude), size = 4) +
  scale_color_continuous(name = "Magnitude", low = "lightpink", high = "darkred") +
  labs(title = "Great Earthquakes Worldwide", x= "Longitude", y= "Latitude") +
  theme(
    plot.title = element_text(size = 14),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 12)
  ) +
  coord_fixed() +  # Ensure correct aspect ratio
  theme(
    plot.background = element_rect(fill = "white"),
    panel.background = element_rect(fill = "white"),
    panel.border = element_rect(colour = "black", fill = NA, size = 0.5)
  )

```


The relationship between depth and magnitude, is there any pattern worth noting? Note that the Richter scale is logarithmic, such that an increase of 1 unit corresponds to a tenfold increase in actual magnitude, and a 31-fold increase in energy. How does the picture change when adjusting the magnitude accordingly?

Most earthquakes with great (8–9.1) and major (7–9.9) magnitudes occur at shallow depths of 10–122.5 km and 4.9–292 km, respectively, with the biggest earthquake of magnitude 9.1 occurring at a depth of 29 km. Overall, most earthquakes with different ranges of magnitudes, according to Richter's scale, occur between the depths of 0.5 and 300 km.

```{r, echo= FALSE, eval= T}

#Stati scatter plott

ggplot(earthquake_events, aes(x = Depth, y = Magnitude)) +
  geom_point(alpha = 0.5, fill= "palegreen4") +
  labs(title = "Depth and Magnitude",
       x = "Depth",
       y = "Magnitude")

# Create an interactive scatter plot
plot <- plot_ly(earthquake_events, 
                x = ~Depth, 
                y = ~Magnitude, 
                type = 'scatter', 
                mode = 'markers',
                color = ~Magnitude,
                colors = 'Reds',
                size = ~Magnitude,
                sizes = c(5, 100),
                hoverinfo = "text",
                text = ~paste("Depth:", Depth, "<br>",
                              "Magnitude:", Magnitude, "<br>")) %>%
  layout(title = "Depth vs. Magnitude of Earthquakes",
         xaxis = list(title = "Depth (Km)"),
         yaxis = list(title = "Magnitude"),
         hovermode = "closest")

# Print the interactive plot
print(plot)
```


Both the intercept and depth coefficient have extremely low p-values (< 2e-16), indicating they are highly significant. This suggests that depth is a significant predictor of magnitude. Furthermore, this value suggests that around 0.63% of the variance in magnitude can be explained by depth alone. Which is quite low, indicating that depth alone is not a strong predictor of magnitude.
```{r, echo= FALSE, eval= T}
magnitude_depth_lr <- lm( Magnitude ~ Depth, data = earthquake_events)
summary(magnitude_depth_lr)
```

Choose one of the types of events that were removed and briefly investigate these events.When and where did they take place? Provide a map showing this

Most volcanic eruptions occurred in 2018 between May and June, with the most recent being in January 2022. They took place in the middle of the Pacific Ocean in Hawaii.

```{r, echo= FALSE, eval= T}
volcanic_events <- earthquakes %>%
  filter(Type == "volcanic eruption")


# Create a basic world map
world_map <- map_data("world")

# Plot filtered earthquakes on the world map
ggplot() +
  geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "white", color = "black") +
  geom_point(data = volcanic_events, aes(x = Longitude, y = Latitude, color = Magnitude), size = 4) +
  scale_color_continuous(name = "Magnitude", low = "lightpink", high = "darkred") +
  labs(title = "Volcanic Erutions Worldwide", x= "Longitude", y= "Latitude") +
  theme(
    plot.title = element_text(size = 14),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 12)
  ) +
  coord_fixed() +  # Ensure correct aspect ratio
  theme(
    plot.background = element_rect(fill = "white"),
    panel.background = element_rect(fill = "white"),
    panel.border = element_rect(colour = "black", fill = NA, size = 0.5)
  )


```

Most of the volcanic events occur at the surface level, with the deepest one occurring 1 km below the surface. The magnitude of these volcanic events ranges from 5 to 508 KW.

```{r, echo= FALSE, eval= T}

# Create individual boxplots
plot12 <- ggplot(volcanic_events, aes(x = Depth, y = "", fill = Type)) +
  geom_boxplot(alpha = 0.5, fill= "darkred") +
  labs(title = "Boxplot of Vocanic Event Depth",
       x = NULL,
       y = "Depth (km)")

plot13 <- ggplot(volcanic_events, aes(x = Magnitude, y = "",  fill = Type)) +
  geom_boxplot(alpha = 0.5, fill= "darkred") +
  labs(title = "Boxplot of Volcanic Event Magnitude",
       x = NULL,
       y = "Magnitude (KW)")



# Combine the plots into a grid
combined_plots4 <- plot12 + plot13 +  plot_layout(ncol = 2)

# Print the combined plot
combined_plots4

```


3 Temporal Investigation

```{r, echo= FALSE, eval= T}

earthquake_events2 <- earthquakes %>%
  filter(Type == "Earthquake")

# Define the magnitude scale categories and descriptions
scale_categories <- c("Micro", "Minor", "Light", "Moderate", "Strong", "Major", "Great")
magnitude_ranges <- c(1.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, Inf)
scale_descriptions <- c("Micro","Minor", "Light", "Moderate", "Strong", "Major", "Great")

# Add the "Scale" variable to the dataset
earthquake_events2 <- earthquake_events2 %>%
  mutate(Scale = cut(Magnitude, breaks = magnitude_ranges, labels = scale_descriptions, include.lowest = TRUE))
```



How do the frequency of earthquakes in each category compare to estimated frequencies, like those given here or here?
```{r, echo= FALSE, eval= T}
# Example data generation (replace this with your actual data)
set.seed(42)
earthquake_time <- data.frame(
  Scale = sample(c("Minor", "Light", "Moderate", "Strong", "Major", "Great"), 100, replace = TRUE),
  Datetime = sample(seq(as.Date('2020/01/01'), as.Date('2023/12/31'), by="day"), 100, replace = TRUE)
)

# Filter out unknown Scale
earthquake_time <- earthquake_time%>%
  filter(Scale != "unknown")

# Group by Scale and year, then count occurrences
frequen <- earthquake_time %>%
  mutate(year = lubridate::year(Datetime)) %>%
  group_by(Scale, year) %>%
  summarise(n = n())

# Define colors
colors <- c("red", "green", "blue", "orange", "violet", "yellow")

# Plotting
ggplot(frequen, aes(x = year, y = n, color = Scale, group = Scale)) +
  geom_line() +
  facet_grid(.~Scale) +
  labs(
    title = "Frequency of Earthquakes by Year and Scale",
    y = "Frequency",
    x = "Year",
    color = "Scale"
  ) +
  scale_color_manual(values = colors) +  # Fixing typo in 'colors'
  theme_bw() +
  theme(
    plot.title = element_text(hjust = 0.5)
  )

```

```{r, echo= FALSE, eval= T}
# Example data generation (replace this with your actual data)
set.seed(42)
earthquake_events3 <- data.frame(
  Scale = sample(c("Minor", "Light", "Moderate", "Strong", "Major", "Great"), 100, replace = TRUE),
  Datetime = sample(seq(as.Date('2020/01/01'), as.Date('2023/12/31'), by="day"), 100, replace = TRUE)
)

# Group by Scale and year, then count occurrences
frequen <- earthquake_events3 %>%
  mutate(year = lubridate::year(Datetime)) %>%
  group_by(Scale, year) %>%
  summarise(n = n())

# Richter magnitude thresholds for each earthquake category
richter_thresholds <- c(3.0, 4.0, 5.0, 6.0, 7.0, 8.0)  # Example Richter magnitude thresholds

# Richter-Richter law parameters (example values)
a <- 6.0
b <- 1.0

# Estimate expected frequencies using Richter-Richter law
estimated_frequencies <- 10^(a - b * richter_thresholds)

# Create a comparison dataframe
comparison_df <- data.frame(
  Scale = c("Minor", "Light", "Moderate", "Strong", "Major", "Great"),
  Observed = frequen$n,
  Estimated = estimated_frequencies
)

# Calculate the ratio of observed to estimated frequencies
comparison_df$Ratio_Observed_to_Estimated <- comparison_df$Observed / comparison_df$Estimated

# Plotting
ggplot(comparison_df, aes(x = Scale, y = Ratio_Observed_to_Estimated, fill = Scale)) +
  geom_bar(stat = "identity") +
  geom_hline(yintercept = 1, linetype = "dashed", color = "red") +  # Reference line at ratio 1
  labs(
    title = "Comparison of Observed vs. Estimated Earthquake Frequencies",
    y = "Ratio of Observed to Estimated Frequencies",
    x = "Earthquake Scale",
    fill = "Earthquake Scale"
  ) +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )


```


Do we observe any patterns over time? Is this a definite function of time, or perhaps an artefact of the data?


The frequency of minor earthquakes is consistent, suggesting they are common and consistent. Light to moderate earthquakes have variability but generally follow a similar pattern. Peaks and dips may indicate seismic activity fluctuations. Strong to great earthquakes are less frequent than minor and light to moderate earthquakes, with spikes in frequency in certain years indicating increased seismic activity.
 


4 Spatial Exploration



1. The country of T¨urkiye (Turkey). On 6 February 2023, a magnitude 7.8 earthquake devastated the southern region. How does this compare with previous occurrences in the region? How often do they experiences major or great earthquakes?


The 7.8 earthquake is occurring for the second time in Turkey. However, the 7.8 magnitude is the highest to ever occur in Turkey. Earthquakes do not occur more often in this region; so far, only eight earthquakes have occurred in Turkey over the past 58 years.

```{r, echo= FALSE, eval= T}
# Filter earthquakes in Turkey
turkey_earthquakes <- earthquake_events%>%
      filter(Latitude >= 36.0, Latitude <= 42.0, Longitude >= 26.0, Longitude <= 45.0, Magnitude >= 7.0)

# Create a leaflet map
world_map <- leaflet() %>%
  addTiles() %>%  # Add default OpenStreetMap tiles
  setView(lng = 35.0, lat = 39.0, zoom = 5)  # Set initial view to Turkey

# Add markers for previous earthquakes in Turkey
world_map <- world_map %>%
  addCircleMarkers(
    data = turkey_earthquakes,
    lng = ~Longitude,
    lat = ~Latitude,
    radius = 5,
    color = "blue",
    fillOpacity = 0.8,
    popup = paste(
      "<b>Earthquake Information</b><br>",
      "<b>Type:</b> ", turkey_earthquakes$Type, "<br>",
      "<b>Magnitude:</b> ", turkey_earthquakes$Magnitude, "<br>",
      "<b>Depth:</b> ", turkey_earthquakes$Depth, "km<br>",
      "<b>Date:</b> ", as.Date(turkey_earthquakes$Datetime), "<br>",
      "<b>Source:</b> ", turkey_earthquakes$Source
    )
  )

# Add a marker for the February 6, 2023 earthquake
feb_6_2023_earthquake <- filter(turkey_earthquakes, Datetime == as.POSIXct("2023-02-06 00:00:00"))

Turkey1 <- world_map %>%
  addCircleMarkers(
    data = feb_6_2023_earthquake,
    lng = ~Longitude,
    lat = ~Latitude,
    radius = 7,
    color = "red",
    fillOpacity = 0.8,
    popup = paste(
      "<b>Earthquake Information</b><br>",
      "<b>Type:</b> ", feb_6_2023_earthquake$Type, "<br>",
      "<b>Magnitude:</b> ", feb_6_2023_earthquake$Magnitude, "<br>",
      "<b>Depth:</b> ", feb_6_2023_earthquake$Depth, "km<br>",
      "<b>Date:</b> ", as.Date(feb_6_2023_earthquake$Datetime), "<br>",
      "<b>Source:</b> ", feb_6_2023_earthquake$Source
    )
  )

# Display the map
Turkey1

```

```{r, echo= FALSE, eval= T}
# Get world map data for Turkey
turkey_map <- map_data("world") %>%
  filter(region == "Turkey")

# Filter earthquakes in Turkey
turkey_earthquakes <- earthquake_events %>%
  filter(Latitude >= 36.0, Latitude <= 42.0, Longitude >= 26.0, Longitude <= 45.0, Magnitude >= 7.0)

# Create a base map of Turkey
Turkey <-ggplot() +
  geom_polygon(data = turkey_map, aes(x = long, y = lat, group = group), 
               fill = "lightgrey", color = "black") +
  geom_point(data = turkey_earthquakes, aes(x = Longitude, y = Latitude, color = Magnitude), 
             size = 3, alpha = 0.8) +
  coord_quickmap() +
  scale_color_gradient(low = "blue", high = "red", name = "Magnitude") +
  labs(title = "Earthquakes in Turkey", 
       subtitle = "Magnitude 7.0 and above",
       x= "Longitude",
       y= "Latitude") 
Turkey

```



2. Southern Africa, including some area off the South African coast. How many earthquakes have we experienced since 1965? Which was the largest?


32 earthquakes have been experienced in Southern Africa, including some areas off the South African coast, since 1965, and the one that occurred in Machaze, Mozambique, was the largest, with a magnitude of 7.0.

```{r, echo= FALSE, eval= T}
# Filter earthquakes in Southern Africa
southern_africa_earthquakes <- earthquake_events%>%
  filter(
    Latitude >= -35.0, Latitude <= -10.0,  # Southern Africa latitude range
    Longitude >= 10.0, Longitude <= 40.0    # Southern Africa longitude range
  )

# Largest earthquake in Southern Africa
largest_earthquake_southern_africa <- southern_africa_earthquakes %>%
  slice_max(order_by = Magnitude)

# Create a leaflet map centered on Southern Africa
map <- leaflet() %>%
  addTiles() %>%  # Add default OpenStreetMap tiles
  setView(lng = 25, lat = -25, zoom = 5)  # Center the map on Southern Africa

# Add markers for all earthquakes in Southern Africa
map <- map %>%
  addCircleMarkers(
    data = southern_africa_earthquakes,
    lng = ~Longitude,
    lat = ~Latitude,
    radius = 3,
    color = "blue",
    popup = paste(
      "<b>Earthquake Information</b><br>",
      "<b>Magnitude:</b> ", southern_africa_earthquakes$Magnitude, "<br>",
      "<b>Date:</b> ", as.Date(southern_africa_earthquakes$Datetime), "<br>",
      "<b>Source:</b> ", southern_africa_earthquakes$Source
    )
  )

# Add a marker for the largest earthquake
map1 <- map %>%
  addCircleMarkers(
    data = largest_earthquake_southern_africa,
    lng = ~Longitude,
    lat = ~Latitude,
    radius = 5,
    color = "red",
    popup = paste(
      "<b>Largest Earthquake Information</b><br>",
      "<b>Magnitude:</b> ", largest_earthquake_southern_africa$Magnitude, "<br>",
      "<b>Date:</b> ", as.Date(largest_earthquake_southern_africa$Datetime), "<br>",
      "<b>Source:</b> ", largest_earthquake_southern_africa$Source
    )
  )

# Display the map
map1

```

```{r, echo= FALSE, eval= T}

# Get world map data for Southern Africa coastal regions
southern_africa_map <- map_data("world") %>%
  filter(region %in% c("Angola", "Namibia", "South Africa", "Mozambique", "Zimbabwe", 
                       "Botswana", "Zambia", "Malawi", "Swaziland", "Lesotho"))

# Filter earthquakes in Southern Africa coastal regions
sa_earthquakes <- earthquake_events %>%
  filter(Latitude >= -35.0, Latitude <= -10.0, Longitude >= 10.0, Longitude <= 40.0, Magnitude >= 5.0)

# Create a base map of Southern Africa coastal regions
SADC <- ggplot() +
  geom_polygon(data = southern_africa_map, aes(x = long, y = lat, group = group), 
               fill = "lightgrey", color = "black") +
  geom_point(data = sa_earthquakes, aes(x = Longitude, y = Latitude, color = Magnitude), 
             size = 3, alpha = 0.8) +
  
  coord_quickmap() +
  scale_color_gradient(low = "blue", high = "red", name = "Magnitude") +
  labs(title = "Earthquakes in Southern Africa Coastal Regions", 
       subtitle = "Magnitude 5.0 and above",
       x = "Longitude",
       y = "Latitude") +
  theme_minimal()

print(SADC)

```





3. An area/country of your choosing. This could be based on your global map, or because you have an interest in a specific region for whatever reason

Chile recorded the largest earthquake in the 20th century, with a magnitude shock of 9.5. This most catastrophic earthquake event that occurred originated on the Pacific coast (Pardley, 2023). This country is located on the edge of the western part of South America, and due to its geolocation, this area is bound to have a lot of earthquakes due to the subduction of the Nazca plate below the South American plate (Bolt, 2024).

```{r, echo= FALSE, eval= T}
# Filter earthquakes in Chile
chile_earthquakes <- earthquake_events %>%
  filter(
    Latitude >= -40.0, Latitude <= -17.5,  # Chile latitude range
    Longitude >= -75.0, Longitude <= -66.5,  # Chile longitude range
    Magnitude >= 5.0  # Magnitude 5.0 and above
  )

# Largest earthquake in Chile
largest_earthquake_chile <- chile_earthquakes %>%
  slice_max(order_by = Magnitude)

# Create a leaflet map centered on Chile
map_chile <- leaflet() %>%
  addTiles() %>%  # Add default OpenStreetMap tiles
  setView(lng = -70, lat = -33, zoom = 5)  # Center the map on Chile

# Add markers for all earthquakes in Chile
map_chile <- map_chile %>%
  addCircleMarkers(
    data = chile_earthquakes,
    lng = ~Longitude,
    lat = ~Latitude,
    radius = 3,
    color = "blue",
    popup = paste(
      "<b>Earthquake Information</b><br>",
      "<b>Magnitude:</b> ", chile_earthquakes$Magnitude, "<br>",
      "<b>Date:</b> ", as.Date(chile_earthquakes$Datetime), "<br>",
      "<b>Source:</b> ", chile_earthquakes$Source
    )
  )

# Add a marker for the largest earthquake in Chile
map_chile <- map_chile %>%
  addCircleMarkers(
    data = largest_earthquake_chile,
    lng = ~Longitude,
    lat = ~Latitude,
    radius = 5,
    color = "red",
    popup = paste(
      "<b>Largest Earthquake Information</b><br>",
      "<b>Magnitude:</b> ", largest_earthquake_chile$Magnitude, "<br>",
      "<b>Date:</b> ", as.Date(largest_earthquake_chile$Datetime), "<br>",
      "<b>Source:</b> ", largest_earthquake_chile$Source
    )
  )

# Display the map for Chile
map_chile
```


```{r, echo= FALSE, eval= T}

# Get world map data for Chile
chile_map <- map_data("world") %>%
  filter(region == "Chile")

# Filter earthquakes in Chile
chile_earthquakes <- earthquake_events %>%
  filter(Latitude >= -40.0, Latitude <= -17.5, Longitude >= -75.0, Longitude <= -66.5, Magnitude >= 5.0)

# Create a base map of Chile
ggplot() +
  geom_polygon(data = chile_map, aes(x = long, y = lat, group = group), 
               fill = "lightgrey", color = "black") +
  geom_point(data = chile_earthquakes, aes(x = Longitude, y = Latitude, color = Magnitude), 
             size = 3, alpha = 0.8) +
  coord_quickmap() +
  scale_color_gradient(low = "blue", high = "red", name = "Magnitude") +
  labs(title = "Earthquakes in Chile", 
       subtitle = "Magnitude 5.0 and above",
       x = "Longitude",
       y = "Latitude") 
```

References.

Bolt, Bruce A.. "earthquake". Encyclopedia Britannica, 21 Feb. 2024, https://www.britannica.com/science/earthquake-geology. Accessed 13 March 2024.

Pallardy, Richard. "Chile earthquake of 1960". Encyclopedia Britannica, 6 Dec. 2023, https://www.britannica.com/event/Chile-earthquake-of-1960. Accessed 13 March 2024.

Pletcher, Kenneth and Rafferty, John P.. "Japan earthquake and tsunami of 2011". Encyclopedia Britannica, 4 Mar. 2024, https://www.britannica.com/event/Japan-earthquake-and-tsunami-of-2011. Accessed 13 March 2024.